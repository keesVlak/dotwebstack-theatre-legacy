var fullScreenFlag=false;function togglefullscreen(){if(fullScreenFlag){$("#graphcanvas").css({position:"relative",left:"",top:"",width:"",height:"",zIndex:""});d3.select("#jointmodel").select("svg").attr("height",400)}else{$("#graphcanvas").css({position:"absolute",left:0,top:0,width:$(window).width(),height:$(window).height(),zIndex:1000});d3.select("#jointmodel").select("svg").attr("height",$(window).height()-100)}fullScreenFlag=!fullScreenFlag}var graph=new joint.dia.Graph;var paper=new joint.dia.Paper({el:$("#jointmodel"),width:"100%",height:400,model:graph,gridSize:1});paper.on("blank:pointerdown",function(b,a,c){dragStartPosition={x:a,y:c}});paper.on("cell:pointerup blank:pointerup",function(b,a,c){delete dragStartPosition});$("#jointmodel").mousemove(function(a){if(typeof(dragStartPosition)!="undefined"){paper.setOrigin(a.offsetX-dragStartPosition.x,a.offsetY-dragStartPosition.y)}});graph.fromJSON(cells);_.each(graph.getLinks(),function(a){if(a.attributes.ldttype==="isa"){a.attr({".connection":{stroke:"#000000","stroke-width":1},".marker-target":{fill:"#FFFFFF",stroke:"#000000",d:"M 14 0 L 0 7 L 14 14 z"}})}else{if(a.attributes.ldttype==="role"){a.attr({".connection":{stroke:"#000000","stroke-width":1,"stroke-dasharray":"5,5"},".marker-target":{fill:"#FFFFFF",stroke:"#000000",d:"M 14 0 L 0 7 L 14 14 z"}})}else{a.attr({".connection":{stroke:"#000000","stroke-width":1},".marker-target":{fill:"#000000",stroke:"#000000",d:"M 8 0 L 0 4 L 8 8 z"}});a.label(0,{attrs:{text:{"font-size":12,"font-weight":"normal"}}})}}});_.each(graph.getElements(),function(a){a.attr({".uml-state-name":{ref:".uml-state-body","ref-x":0.5,"ref-y":5,"text-anchor":"middle",fill:"#000000","font-family":"Arial","font-size":14},".uml-state-events":{ref:".uml-state-separator","ref-x":5,"ref-y":5,fill:"#000000","font-family":"Arial","font-size":12}});var b=paper.findViewByModel(a).getBBox().width+10;if(a.attributes.events){a.resize(Math.max(b,100),30+Math.max(a.attributes.events.length*12,10))}});var graphBBox=joint.layout.DirectedGraph.layout(graph,{nodeSep:100,edgeSep:40,rankDir:"TB"});_.each(graph.getLinks(),function(a){paper.findViewByModel(a).update()});paper.on("cell:pointerup",function(a){_.each(graph.getLinks(),function(b){paper.findViewByModel(b).update()})});